<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Distance-based velocity based on geographically closest climate analogue — dVoCC • VoCC</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Distance-based velocity based on geographically closest climate analogue — dVoCC"><meta property="og:description" content="Function to calculate the geographically closest climate analogues and related distance-based velocity. Cell analogues
are identified by comparing the baseline climatic conditions at each focal cell with those existing for all
other (target) cells in the future by reference to a specified climatic threshold. The function allows for the
specification of search distances and incorporates both least-cost path and Great Circle (as-the-crow-flies) distances."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VoCC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/VoCC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JorGarMol/VoCC/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Distance-based velocity based on geographically closest climate analogue</h1>
    <small class="dont-index">Source: <a href="https://github.com/JorGarMol/VoCC/blob/HEAD/R/dVoCC.R" class="external-link"><code>R/dVoCC.R</code></a></small>
    <div class="hidden name"><code>dVoCC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to calculate the geographically closest climate analogues and related distance-based velocity. Cell analogues
are identified by comparing the baseline climatic conditions at each focal cell with those existing for all
other (target) cells in the future by reference to a specified climatic threshold. The function allows for the
specification of search distances and incorporates both least-cost path and Great Circle (as-the-crow-flies) distances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dVoCC</span><span class="op">(</span></span>
<span>  <span class="va">clim</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">tdiff</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Single"</span>,</span>
<span>  <span class="va">climTol</span>,</span>
<span>  <span class="va">geoTol</span>,</span>
<span>  distfun <span class="op">=</span> <span class="st">"GreatCircle"</span>,</span>
<span>  trans <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  lonlat <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-clim">clim<a class="anchor" aria-label="anchor" href="#arg-clim"></a></dt>
<dd><p><code>data.frame</code> with the value for the climatic parameters (columns) by cell (rows), arranged as follows (see examples below):
The first 2n columns must contain the present and future values for each of the n climatic variables (V1p, V1f, V2p, V2f,...).
Where cell-specific analogue thresholds (see "variable" in "method" below) are to be calculated, the next (2n+1:3n) columns
should contain the standard deviation (or any other measure of climatic variability) of each variable for the baseline period.
These columns are not required if using the "Single" method. The last three columns of the table should contain an identifyier and centroid coordinates of each cell.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>integer</code> defining the number of climatic variables.</p></dd>


<dt id="arg-tdiff">tdiff<a class="anchor" aria-label="anchor" href="#arg-tdiff"></a></dt>
<dd><p><code>integer</code> defining the number of years (or other temporal unit) between periods.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>ch)aracter string</code> specifying the analogue method to be used. 'Single': a constant, single analogue threshold
for each climate variable is applied to all cells (Ohlemuller et al. 2006, Hamann et al. 2015); climate analogy corresponds to target cells
with values below the specified threshold for each climatic variable. 'Variable': a cell-specific climate threshold is used for each climatic variable
to determine the climate analogues associated with each cell by reference to its baseline climatic variability (Garcia Molinos et al. 2017).</p></dd>


<dt id="arg-climtol">climTol<a class="anchor" aria-label="anchor" href="#arg-climtol"></a></dt>
<dd><p><code>numeric</code> a vector of length n giving the tolerance threshold defining climate analogue conditions for each climatic variable.
If a cell-specific threshold is being used, this function parameter should be passed as NA.</p></dd>


<dt id="arg-geotol">geoTol<a class="anchor" aria-label="anchor" href="#arg-geotol"></a></dt>
<dd><p><code>integer</code> impose a geographical distance threshold (in km for lat/lon or map units if projected).
If used, the pool of potential climate analogues will be limited to cells within that distance from the focal cell.</p></dd>


<dt id="arg-distfun">distfun<a class="anchor" aria-label="anchor" href="#arg-distfun"></a></dt>
<dd><p><code>character string</code> specifying the function to be used for estimating distances
between focal and target cells. Either 'Euclidean', 'GreatCircle' (Great Circle Distances).
'LeastCost' (Least Cost Path Distances) is NOT CURRENTLY IMPLEMENTED. LeastCost requires a transition matrix supplied to the function via de 'trans' argument.</p></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p><code>TransitionLayer</code> NOT CURRENTLY IMPLEMENTED gdistance object to be used for the analogue search if distfun = 'LeastCost'.</p></dd>


<dt id="arg-lonlat">lonlat<a class="anchor" aria-label="anchor" href="#arg-lonlat"></a></dt>
<dd><p><code>logical</code> is the analysis to be done in unprojected (lon/lat) coordinates?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>data.frame</code> containing the cell id of the future analogue for each focal cell (NA = no analogue available),
together with the climatic ("climDis") and geographical ("geoDis") distances in input units,
the bearing ("ang", degrees North), and resulting climate velocity ("vel", km/yr). Mean climatic distances are returned for multivariate analogues.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1466-822X.2006.00245.x" class="external-link">Ohlemuller et al. 2006</a>. Towards European climate risk surfaces: the extent and distribution of analogous and non-analogous climates 1931-2100. Global Ecology and Biogeography, 15, 395-405. <br><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.12736" class="external-link">Hamann et al. 2015</a>. Velocity of climate change algorithms for guiding conservation and management. Global Change Biology, 21, 997-1004. <br><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.13665" class="external-link">Garcia Molinos et al. 2017</a>. Improving the interpretability of climate landscape metrics: An ecological risk analysis of Japan's Marine Protected Areas. Global Change Biology, 23, 4440-4452.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="climPCA.html">climPCA</a></code>, <code><a href="climPlot.html">climPlot</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Jorge Garcia Molinos</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">JapTC</span> <span class="op">&lt;-</span> <span class="fu">VoCC_get_data</span><span class="op">(</span><span class="st">"JapTC.tif"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a data frame with the necessary variables in the required order</span></span></span>
<span class="r-in"><span><span class="va">clim</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">)</span>, cid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clim</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">xyFromCell</a></span><span class="op">(</span><span class="va">JapTC</span>, <span class="va">clim</span><span class="op">$</span><span class="va">cid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Constant threshold, distance-restricted velocity based on geographical distances</span></span></span>
<span class="r-in"><span><span class="va">avocc1</span> <span class="op">&lt;-</span> <span class="fu">dVoCC</span><span class="op">(</span><span class="va">clim</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">3</span>, tdiff <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"Single"</span>, climTol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  geoTol <span class="op">=</span> <span class="fl">160</span>, distfun <span class="op">=</span> <span class="st">"GreatCircle"</span>, trans <span class="op">=</span> <span class="cn">NA</span>, lonlat <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r1</span><span class="op">[</span><span class="va">avocc1</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc1</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cell-specific, distance-unrestricted climate analogue velocity based on least-cost path distances</span></span></span>
<span class="r-in"><span><span class="co"># First, create the conductance matrix (all land cells considered to have conductance of 1)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">h8</span> <span class="op">&lt;-</span> <span class="fu">gdistance</span><span class="fu">::</span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/transition.html" class="external-link">transition</a></span><span class="op">(</span><span class="va">r</span>, transitionFunction <span class="op">=</span> <span class="va">mean</span>, directions <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h8</span> <span class="op">&lt;-</span> <span class="fu">gdistance</span><span class="fu">::</span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/geoCorrection.html" class="external-link">geoCorrection</a></span><span class="op">(</span><span class="va">h8</span>, type <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now calculate the analogue velocity using the baseline SD for each variable as analogue threshold</span></span></span>
<span class="r-in"><span><span class="va">avocc2</span> <span class="op">&lt;-</span> <span class="fu">dVoCC</span><span class="op">(</span><span class="va">clim</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">3</span>, tdiff <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"Variable"</span>, climTol <span class="op">=</span> <span class="cn">NA</span>, geoTol <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>  distfun <span class="op">=</span> <span class="st">"LeastCost"</span>, trans <span class="op">=</span> <span class="va">h8</span>, lonlat <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot results</span></span></span>
<span class="r-in"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r1</span><span class="op">[</span><span class="va">avocc1</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc1</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="va">r2</span><span class="op">[</span><span class="va">avocc2</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc2</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1</span>, <span class="va">r2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jorge Garcia Molinos, David S. Schoeman, Christopher J. Brown, Michael T. Burrows.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

