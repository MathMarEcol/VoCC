<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distance-based velocity based on geographically closest climate analogue — dVoCC • VoCC</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distance-based velocity based on geographically closest climate analogue — dVoCC"><meta name="description" content="Function to calculate the geographically closest climate analogues and related distance-based velocity. Cell analogues
are identified by comparing the baseline climatic conditions at each focal cell with those existing for all
other (target) cells in the future by reference to a specified climatic threshold. The function allows for the
specification of search distances and incorporates both least-cost path and Great Circle (as-the-crow-flies) distances."><meta property="og:description" content="Function to calculate the geographically closest climate analogues and related distance-based velocity. Cell analogues
are identified by comparing the baseline climatic conditions at each focal cell with those existing for all
other (target) cells in the future by reference to a specified climatic threshold. The function allows for the
specification of search distances and incorporates both least-cost path and Great Circle (as-the-crow-flies) distances."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VoCC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/VoCC.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/MathMarEcol/VoCC/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Distance-based velocity based on geographically closest climate analogue</h1>
      <small class="dont-index">Source: <a href="https://github.com/MathMarEcol/VoCC/blob/HEAD/R/dVoCC.R" class="external-link"><code>R/dVoCC.R</code></a></small>
      <div class="d-none name"><code>dVoCC.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to calculate the geographically closest climate analogues and related distance-based velocity. Cell analogues
are identified by comparing the baseline climatic conditions at each focal cell with those existing for all
other (target) cells in the future by reference to a specified climatic threshold. The function allows for the
specification of search distances and incorporates both least-cost path and Great Circle (as-the-crow-flies) distances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dVoCC</span><span class="op">(</span></span>
<span>  <span class="va">clim</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">tdiff</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Single"</span>,</span>
<span>  <span class="va">climTol</span>,</span>
<span>  <span class="va">geoTol</span>,</span>
<span>  distfun <span class="op">=</span> <span class="st">"GreatCircle"</span>,</span>
<span>  trans <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  lonlat <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-clim">clim<a class="anchor" aria-label="anchor" href="#arg-clim"></a></dt>
<dd><p><code>data.frame</code> with the value for the climatic parameters (columns) by cell (rows), arranged as follows (see examples below):
The first 2n columns must contain the present and future values for each of the n climatic variables (V1p, V1f, V2p, V2f,...).
Where cell-specific analogue thresholds (see "variable" in "method" below) are to be calculated, the next (2n+1:3n) columns
should contain the standard deviation (or any other measure of climatic variability) of each variable for the baseline period.
These columns are not required if using the "Single" method. The last three columns of the table should contain an identifyier and centroid coordinates of each cell.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p><code>integer</code> defining the number of climatic variables.</p></dd>


<dt id="arg-tdiff">tdiff<a class="anchor" aria-label="anchor" href="#arg-tdiff"></a></dt>
<dd><p><code>integer</code> defining the number of years (or other temporal unit) between periods.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>ch)aracter string</code> specifying the analogue method to be used. 'Single': a constant, single analogue threshold
for each climate variable is applied to all cells (Ohlemuller et al. 2006, Hamann et al. 2015); climate analogy corresponds to target cells
with values below the specified threshold for each climatic variable. 'Variable': a cell-specific climate threshold is used for each climatic variable
to determine the climate analogues associated with each cell by reference to its baseline climatic variability (Garcia Molinos et al. 2017).</p></dd>


<dt id="arg-climtol">climTol<a class="anchor" aria-label="anchor" href="#arg-climtol"></a></dt>
<dd><p><code>numeric</code> a vector of length n giving the tolerance threshold defining climate analogue conditions for each climatic variable.
If a cell-specific threshold is being used, this function parameter should be passed as NA.</p></dd>


<dt id="arg-geotol">geoTol<a class="anchor" aria-label="anchor" href="#arg-geotol"></a></dt>
<dd><p><code>integer</code> impose a geographical distance threshold (in km for lat/lon or map units if projected).
If used, the pool of potential climate analogues will be limited to cells within that distance from the focal cell.</p></dd>


<dt id="arg-distfun">distfun<a class="anchor" aria-label="anchor" href="#arg-distfun"></a></dt>
<dd><p><code>character string</code> specifying the function to be used for estimating distances
between focal and target cells. Either 'Euclidean', 'GreatCircle' (Great Circle Distances).
'LeastCost' (Least Cost Path Distances) is NOT CURRENTLY IMPLEMENTED. LeastCost requires a transition matrix supplied to the function via de 'trans' argument.</p></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p><code>TransitionLayer</code> NOT CURRENTLY IMPLEMENTED gdistance object to be used for the analogue search if distfun = 'LeastCost'.</p></dd>


<dt id="arg-lonlat">lonlat<a class="anchor" aria-label="anchor" href="#arg-lonlat"></a></dt>
<dd><p><code>logical</code> is the analysis to be done in unprojected (lon/lat) coordinates?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> containing the cell id of the future analogue for each focal cell (NA = no analogue available),
together with the climatic ("climDis") and geographical ("geoDis") distances in input units,
the bearing ("ang", degrees North), and resulting climate velocity ("vel", km/yr). Mean climatic distances are returned for multivariate analogues.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1466-822X.2006.00245.x" class="external-link">Ohlemuller et al. 2006</a>. Towards European climate risk surfaces: the extent and distribution of analogous and non-analogous climates 1931-2100. Global Ecology and Biogeography, 15, 395-405. <br><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.12736" class="external-link">Hamann et al. 2015</a>. Velocity of climate change algorithms for guiding conservation and management. Global Change Biology, 21, 997-1004. <br><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.13665" class="external-link">Garcia Molinos et al. 2017</a>. Improving the interpretability of climate landscape metrics: An ecological risk analysis of Japan's Marine Protected Areas. Global Change Biology, 23, 4440-4452.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="climPCA.html">climPCA</a></code>, <code><a href="climPlot.html">climPlot</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jorge Garcia Molinos</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">JapTC</span> <span class="op">&lt;-</span> <span class="fu">VoCC_get_data</span><span class="op">(</span><span class="st">"JapTC.tif"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a data frame with the necessary variables in the required order</span></span></span>
<span class="r-in"><span><span class="va">clim</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">)</span>, cid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clim</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">xyFromCell</a></span><span class="op">(</span><span class="va">JapTC</span>, <span class="va">clim</span><span class="op">$</span><span class="va">cid</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Constant threshold, distance-restricted velocity based on geographical distances</span></span></span>
<span class="r-in"><span><span class="va">avocc1</span> <span class="op">&lt;-</span> <span class="fu">dVoCC</span><span class="op">(</span><span class="va">clim</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">3</span>, tdiff <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"Single"</span>, climTol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  geoTol <span class="op">=</span> <span class="fl">160</span>, distfun <span class="op">=</span> <span class="st">"GreatCircle"</span>, trans <span class="op">=</span> <span class="cn">NA</span>, lonlat <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r1</span><span class="op">[</span><span class="va">avocc1</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc1</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cell-specific, distance-unrestricted climate analogue velocity based on least-cost path distances</span></span></span>
<span class="r-in"><span><span class="co"># First, create the conductance matrix (all land cells considered to have conductance of 1)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">JapTC</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">h8</span> <span class="op">&lt;-</span> <span class="fu">gdistance</span><span class="fu">::</span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/transition.html" class="external-link">transition</a></span><span class="op">(</span><span class="va">r</span>, transitionFunction <span class="op">=</span> <span class="va">mean</span>, directions <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">h8</span> <span class="op">&lt;-</span> <span class="fu">gdistance</span><span class="fu">::</span><span class="fu"><a href="https://AgrDataSci.github.io/gdistance/reference/geoCorrection.html" class="external-link">geoCorrection</a></span><span class="op">(</span><span class="va">h8</span>, type <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now calculate the analogue velocity using the baseline SD for each variable as analogue threshold</span></span></span>
<span class="r-in"><span><span class="va">avocc2</span> <span class="op">&lt;-</span> <span class="fu">dVoCC</span><span class="op">(</span><span class="va">clim</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">3</span>, tdiff <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"Variable"</span>, climTol <span class="op">=</span> <span class="cn">NA</span>, geoTol <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>  distfun <span class="op">=</span> <span class="st">"LeastCost"</span>, trans <span class="op">=</span> <span class="va">h8</span>, lonlat <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot results</span></span></span>
<span class="r-in"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="va">r2</span> <span class="op">&lt;-</span> <span class="va">JapTC</span></span></span>
<span class="r-in"><span><span class="va">r1</span><span class="op">[</span><span class="va">avocc1</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc1</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="va">r2</span><span class="op">[</span><span class="va">avocc2</span><span class="op">$</span><span class="va">focal</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">avocc2</span><span class="op">$</span><span class="va">vel</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1</span>, <span class="va">r2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jorge Garcia Molinos, David S. Schoeman, Christopher J. Brown, Michael T. Burrows.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

