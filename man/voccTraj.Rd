% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/voccTraj.R
\name{voccTraj}
\alias{voccTraj}
\title{Climate velocity trajectories}
\usage{
voccTraj(
  lonlat,
  vel,
  ang,
  mn,
  tstep,
  x_res = NULL,
  y_res = NULL,
  tyr = 20,
  bfr = 75,
  grid_resolution = "coarse",
  seed = NULL
)
}
\arguments{
\item{lonlat}{\code{data.frame} with the longitude and latitude (in decimal degrees)
of the points to project.}

\item{vel}{\code{raster} with the magnitude of gradient-based climate velocity.}

\item{ang}{\code{raster} with velocity angles in degrees.}

\item{mn}{\code{raster} with the overall mean climatic value over the period of interest.}

\item{tstep}{Numeric. Timestep for each trajectory iteration (usually decimal year).}

\item{x_res}{Numeric. Resolution of the grid in longitude direction (degrees or km).}

\item{y_res}{Numeric. Resolution of the grid in latitude direction (degrees or km).}

\item{tyr}{Integer. Temporal length of the period of interest (years).}

\item{bfr}{Numeric. Distance around a cell to look for a cooler/warmer cell.}

\item{grid_resolution}{Character. "coarse" (default) or "fine". Controls how land crossings are handled and allows for higher resolution grids.}

\item{seed}{Integer. Random seed for reproducibility. If NULL (default), no seed is set.}
}
\value{
a \code{tibble} containing the coordinates ("lon", "lat") of the constituent
points, time step ("Steps"), identification number ("ID") for each trajectory, and cell IDs for start and end cells.
}
\description{
Function to calculate vocc trajectories after Burrows et al (2014). Trajectories
are calculated by propagating climatic isopleths using the magnitude and direction of
local (cell) velocities. This is a slightly modified version of the original
Burrows et al. (2014) approach in that iterations of a trajectory are based on
cumulative time traveled instead of using fixed time steps.
}
\examples{
\dontrun{
HSST <- terra::rast(system.file("extdata", "HadiSST.tif", package = "VoCCdata"))

yrSST <- sumSeries(HSST,
  p = "1960-01/2009-12", yr0 = "1955-01-01", l = terra::nlyr(HSST),
  fun = function(x) colMeans(x, na.rm = TRUE),
  freqin = "months", freqout = "years"
)

# Long-term local climatic trends
tr <- tempTrend(yrSST, th = 10)

# Local spatial climatic gradients
sg <- spatGrad(yrSST, th = 0.0001, projected = FALSE)

# Gradient-based climate velocity
v <- gVoCC(tr, sg)
vel <- v[[1]]
ang <- v[[2]]

# Calculate the annual SST mean over the period
mn <- terra::mean(yrSST, na.rm = TRUE)

# Get the set of starting cells for the trajectories
lonlat <- stats::na.omit(data.frame(
  terra::xyFromCell(vel, 1:terra::ncell(vel)),
  vel[], ang[], mn[]
))[, 1:2]

# Calculate trajectories
traj <- voccTraj(lonlat, vel, ang, mn, tstep = 1/4, tyr = 50)
}

}
\references{
\href{https://www.nature.com/articles/nature12976}{Burrows et al. 2014}. Geographical limits to species-range shifts are suggested by climate velocity. Nature, 507, 492-495.
}
\seealso{
{\code{\link{gVoCC}}, \code{\link{trajClas}}}
}
